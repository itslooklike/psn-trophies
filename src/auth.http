
@hardcoded_basic = YWM4ZDE2MWEtZDk2Ni00NzI4LWIwZWEtZmZlYzIyZjY5ZWRjOkRFaXhFcVhYQ2RYZHdqMHY=
@npsso = ***REMOVED***
@code = ***REMOVED***
@refresh_token = ***REMOVED***

@accessToken = eyJraWQiOiJucF8xIiwiYWxnIjoiUlMyNTYifQ.eyJhY2NvdW50X2lkIjoiODcxNjY3MTU1Nzc4OTg2NjEwNiIsImFjY291bnRfdXVpZCI6IjIwZGQ2ZWFmLTc3MTQtNDM1NC1iMzIxLTQ3YWU1ZmQ5ZWJjZiIsImFnZSI6MzUsImF1dGh6X2MiOiJlTnFWVk50dTJ6QU0vWlVnejRPUkxMMU5iMDBhRkFPV29XZyt3RkFrMnRZcVM0WXVicjFoL3o1S3NoMG5UUXNzUUdEcDhJaWtEa245bVhNditKek1GK25IOFgrMVdOd3Q3dTVXVjdmMzk0dk43YmZycTY4UHEvWE45YzEydmI1ZWJyYXI3WHE3bkgrWlc2WWJ3S09NS3NKMFhWUEZNMi9CWkNXNDJUdlFqcUJ5OE9iT21STXdNUjJWdWlST09BbDJ2WWxNRHExZ1FNSVMzaHFwRGE1cERUYWJJdFpwSTNvc1dIZkFCZDJEaVVlWjFKNUg1SkZLQ2FiN2dLYVYxUkl5TkFoVi90QmVsWkQ1aGxNSHN5bjJhTFJ2TElsWjEvb2d3cEhrN3pOS3VKL2d1ZE12b0FndDRiZzVDT09xR0dXRW9qTEs1Y3daZVVTRnpWa2xKRDhpV2ttaElCY0k0UUVwUlFtS3daT2tydENtSnMxeXBXSnVMN1NtdndSaDFMajg0RHVsWHk5QWVXTlFhamcxbldOWVhEQU1ja1dkYUdHQWc1YTVGSGFNaEVIemtKSlJWT1o0azFEUUdyOTJJQVR5dURGY1R0TU1XOHNxNEY3Q0ZPdHIwU1BleURFN1RiMnJDRzBhbzF2SXcwYmxUckFYOUluZHFsQ2ZSdElPekRQRUN5ajBJN0RhSktHcGJScUxMWm1hN2JzcTlCQXR3cUdRVHdZS01FSGZvd2tySlFWZUN5UEhYVi9yZGpscnZLMSthaWNLd1dJczhncUh2UTRaRFEyQk5WYkEzR3gwKzREZGYreEZyNXpwTmxvVm9zd01VRDR6anEyTjRDV1FWaU5sVTFFMytyQzBBTmNOYlpOUlZMMzdEVE43b05XWUZQWUhsZ0NkWmhXMTFjd3lBNkJzUlhGNm9vWVdxR0VWNldjd1N0SkRWak5CWlk5WWk3ZlpZWVFTREdtd1JicDl3akxiV1FmMUlNNDVNeXA5UnAxTXozL1F4d0RPNGNCWm9vdGkwNDl1NnNyZTRZZm14cU01dXR4aEFJeEg2dlROckVQUDZUMGFvbHpramMrWVk1YllWTE1NbXlCRFVjT3BBS2RYTFdVK3dFWTNWVWNvVGpHMGNSNm1FdlJXRG9WUUl2VE1CV05qUkV0Wk43VjRoVTBHL0o3aDNZVHJkanFNVFNwcFNBR2p4V2JLcUhOR0hMekRWN0tsVXNUYm5SRENhS0N6MUsvUFlKSE93bktQb3ZnMEl5ZjhkOEFnZVRaa09UQk9Ca0ZOTmhjRS81dy9DcDhtVWhlb3dvblNVMkUrcDZSNDg3Ly9BQzRRc1AwIiwiY2xpZW50X2lkIjoiYWM4ZDE2MWEtZDk2Ni00NzI4LWIwZWEtZmZlYzIyZjY5ZWRjIiwiZGNpbV9pZCI6ImNlMmZlODJkLTJjOWUtNGI1OC05Y2JmLWM1OWZjM2E4NmU0NSIsImRldmljZV90eXBlIjoiSU9TX0FQUCIsImVudl9pc3NfaWQiOiIyNTYiLCJleHAiOjE2Mzc4ODk0MDksImdyYW50X3R5cGUiOiJhdXRob3JpemF0aW9uX2NvZGUiLCJpYXQiOjE2Mzc4ODU4MDksImlzX2NoaWxkIjpmYWxzZSwiaXNzIjoiaHR0cHM6Ly9hdXRoLmFjY291bnQuc29ueS5jb20vIiwianRpIjoiZmEzZTZiOTItZjA3Yy00NWI5LTk1YTEtOTM4YzBkOGUxMjM0IiwibGVnYWxfY291bnRyeSI6IlJVIiwibG9jYWxlIjoicnUtUlUiLCJ1c2VyX2RldmljZV9pcCI6IjE3Ni45Ni4yNDQuNjciLCJ2ZXIiOiIyIn0.Xba9rn2rUYWd0TJyuACVHO_5GGGHJOoPQS-Nibz-ht_qxVKIaA5k4mAmzTsIFdR5I1A3B7-LAsfM7raZyjuWvXBErJqRtk8PDzKtax6IRve5d0XGD6i0_MrEM2L9BbZ78fwczLcy_Xm9RDNM2KUjEWtxlqcUBe6HaV3lF3jQPUKHtw6kjmLLq0wp6HEWEbPRAudbdxdlOxe66tvwV85b61FJ9noJ2xFJT6Wv31ljlNzEaqpQyrMlMtabpCcTdE9RUSJu5WPouo_LCtUmaPrgwI9gpgYsFJrCj-YTXw8ACc-rkQZjluGt-kHN15DW_-ZHYn4wc75-mRCCyxtoYPtSiUzccv2e5IyCK0rYs6ExWzuhcRbhbN0skOe9UrGB1ZSQU6Z3oQIWw2A2mzMLMfkIP_GdNcIay4icuAJB1ZSIuXQGcacJye9TFS95uVKWtKH4FocdcxXtammYDK5Ze5qgNlhT-BtI2bKEfCVS7F2CVMjPP7EoXJLSUdxMvrPFAor0

@accountId = ***REMOVED***

### получение code, для refresh token
# - необходимо отключить редирект в настройках `"rest-client.followredirect": false,`
# - `code` получаем в `Location` ответе на предыдущий запрос
GET https://ca.account.sony.com/api/authz/v3/oauth/authorize?client_id=ac8d161a-d966-4728-b0ea-ffec22f69edc&redirect_uri=com.playstation.PlayStationApp%3A%2F%2Fredirect&response_type=code&scope=psn%3Amobile.v1%20psn%3Aclientapp HTTP/1.1
Cookie: npsso={{npsso}}

### получение refresh token

POST https://ca.account.sony.com/api/authz/v3/oauth/token HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Authorization: Basic {{hardcoded_basic}}
Cookie: npsso={{npsso}}

code={{code}}&smcid=psapp%3Asettings-entrance&access_type=offline&service_logo=ps&ui=pr&elements_visibility=no_aclink&redirect_uri=com.playstation.PlayStationApp%3A%2F%2Fredirect&support_scheme=sneiprls&grant_type=authorization_code&darkmode=true&device_base_font_size=10&device_profile=mobile&app_context=inapp_ios&extraQueryParams=%7B%20PlatformPrivacyWs1%20%3D%20minimal%3B%20%7D&token_format=jwt

### получение access token

POST https://m.np.playstation.net/api/authz/v3/oauth/token HTTP/1.1
Content-Type: application/x-www-form-urlencoded
Authorization: Basic {{hardcoded_basic}}
User-Agent: PlayStation/21090100 CFNetwork/1126 Darwin/19.5.0
Accept-Language: en-US

refresh_token={{refresh_token}}&grant_type=refresh_token&scope=psn%3Amobile.v1%20psn%3Aclientapp&token_format=jwt

###

@gameId = NPWR08934_00

GET https://m.np.playstation.net/api/trophy/v1/users/{{accountId}}/npCommunicationIds/{{gameId}}/trophyGroups?npServiceName=trophy HTTP/1.1
Authorization: Basic {{accessToken}}
Accept-Language: ru-RU
###

GET https://m.np.playstation.net/api/trophy/v1/npCommunicationIds/{{gameId}}/trophyGroups?npServiceName=trophy HTTP/1.1
Authorization: Basic {{accessToken}}
Accept-Language: ru-RU
